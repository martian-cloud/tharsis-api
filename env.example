# =============================================================================
# THARSIS API CONFIGURATION
# =============================================================================
# This file contains environment variables for configuring the Tharsis API
# Copy this file to .env and modify values as needed for your environment
# =============================================================================

# =============================================================================
# OAUTH PROVIDER CONFIGURATION
# =============================================================================
# Configuration for OAuth authentication providers (KeyCloak in local setup)
THARSIS_OAUTH_PROVIDERS_0_ISSUER_URL=http://localhost:6530/realms/tharsis
THARSIS_OAUTH_PROVIDERS_0_CLIENT_ID=tharsis
THARSIS_OAUTH_PROVIDERS_0_USERNAME_CLAIM=preferred_username
THARSIS_OAUTH_PROVIDERS_0_SCOPE=openid profile email

# =============================================================================
# TFE (TERRAFORM ENTERPRISE) LOGIN CONFIGURATION
# =============================================================================
# Configuration for Terraform Enterprise compatible login functionality
THARSIS_TFE_LOGIN_ENABLED=true
THARSIS_TFE_LOGIN_CLIENT_ID=tharsis
THARSIS_TFE_LOGIN_SCOPES=openid tharsis

# =============================================================================
# ADMIN USER CONFIGURATION
# =============================================================================
# Default admin user email for initial setup
THARSIS_ADMIN_USER_EMAIL=martian@tharsis.local

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL database connection settings
THARSIS_DB_USERNAME=postgres
THARSIS_DB_NAME=tharsis
THARSIS_DB_PASSWORD=postgres
THARSIS_DB_HOST=localhost
THARSIS_DB_PORT=5432
THARSIS_DB_SSL_MODE=disable

# =============================================================================
# OBJECT STORE CONFIGURATION
# =============================================================================
# S3-compatible object storage settings (MinIO for local development)
# Used for storing Terraform state files and other artifacts
THARSIS_OBJECT_STORE_PLUGIN_TYPE=aws_s3
THARSIS_OBJECT_STORE_PLUGIN_DATA_REGION=us-east-1
THARSIS_OBJECT_STORE_PLUGIN_DATA_BUCKET=tharsis-objects
THARSIS_OBJECT_STORE_PLUGIN_DATA_AWS_ACCESS_KEY_ID=minioadmin
THARSIS_OBJECT_STORE_PLUGIN_DATA_AWS_SECRET_ACCESS_KEY=miniopassword
THARSIS_OBJECT_STORE_PLUGIN_DATA_ENDPOINT=http://localhost:9000

# =============================================================================
# JSON WEB SIGNATURE (JWS) PROVIDER CONFIGURATION
# =============================================================================
# Configuration for signing and verifying JWS tokens
THARSIS_JWS_PROVIDER_PLUGIN_TYPE=memory

# =============================================================================
# JOB EXECUTION CONFIGURATION
# =============================================================================
# Configuration for job runners that execute Terraform operations
# Multiple runners can be configured with different execution environments

# Local Job Dispatcher (Runner 0)
# Executes jobs directly on the local machine - simplest setup for development
THARSIS_INTERNAL_RUNNERS_0_NAME=default-local-runner
THARSIS_INTERNAL_RUNNERS_0_JOB_DISPATCHER_TYPE=local
THARSIS_INTERNAL_RUNNERS_0_JOB_DISPATCHER_DATA_API_URL=http://localhost:8000

# Docker Job Dispatcher (Runner 1) - COMMENTED OUT
# Executes jobs in Docker containers - provides isolation and consistent environment
# Uncomment the section below to enable Docker-based job execution
# THARSIS_INTERNAL_RUNNERS_1_NAME=default-docker-runner
# THARSIS_INTERNAL_RUNNERS_1_JOB_DISPATCHER_TYPE=docker
# THARSIS_INTERNAL_RUNNERS_1_JOB_DISPATCHER_DATA_IMAGE=registry.gitlab.com/infor-cloud/martian-cloud/tharsis/tharsis-api/job-executor
# THARSIS_INTERNAL_RUNNERS_1_JOB_DISPATCHER_DATA_LOCAL_IMAGE=false
# THARSIS_INTERNAL_RUNNERS_1_JOB_DISPATCHER_DATA_HOST=unix:///var/run/docker.sock
# THARSIS_INTERNAL_RUNNERS_1_JOB_DISPATCHER_DATA_API_URL=http://localhost:8000
# WSL Host Mapping: Uncomment and set the IP below if running in WSL environment
# This maps 'localhost' inside containers to the WSL host IP so containers can reach the API
# Get the WSL host IP with: hostname -I
# THARSIS_INTERNAL_RUNNERS_1_JOB_DISPATCHER_DATA_EXTRA_HOSTS=localhost:172.15.30.220

# Kubernetes Job Dispatcher (Runner 2) - COMMENTED OUT
# Executes jobs as Kubernetes pods - provides scalability and resource management
# Uncomment the section below to enable Kubernetes-based job execution
# THARSIS_INTERNAL_RUNNERS_2_NAME=default-kubernetes-runner
# THARSIS_INTERNAL_RUNNERS_2_JOB_DISPATCHER_TYPE=kubernetes
# THARSIS_INTERNAL_RUNNERS_2_JOB_DISPATCHER_DATA_API_URL=http://localhost:8000
# THARSIS_INTERNAL_RUNNERS_2_JOB_DISPATCHER_DATA_AUTH_TYPE=kube_config
# THARSIS_INTERNAL_RUNNERS_2_JOB_DISPATCHER_DATA_KUBE_CONFIG_PATH=/home/user/.kube/config
# THARSIS_INTERNAL_RUNNERS_2_JOB_DISPATCHER_DATA_IMAGE=registry.gitlab.com/infor-cloud/martian-cloud/tharsis/tharsis-api/job-executor
# THARSIS_INTERNAL_RUNNERS_2_JOB_DISPATCHER_DATA_MEMORY_REQUEST=256Mi
# THARSIS_INTERNAL_RUNNERS_2_JOB_DISPATCHER_DATA_MEMORY_LIMIT=512Mi
# THARSIS_INTERNAL_RUNNERS_2_JOB_DISPATCHER_DATA_NAMESPACE=default
# WSL Host Aliases: Uncomment and set the IP below if running in WSL environment
# This allows Kubernetes pods to resolve 'localhost' to the WSL host IP for API communication
# Get the WSL host IP with: hostname -I
# THARSIS_INTERNAL_RUNNERS_2_JOB_DISPATCHER_DATA_HOST_ALIASES=localhost:172.15.30.220

# =============================================================================
# OPENTELEMETRY TRACING CONFIGURATION
# =============================================================================
# Configuration for distributed tracing and observability
THARSIS_OTEL_TRACE_ENABLED=true
THARSIS_OTEL_TRACE_TYPE=otlp
THARSIS_OTEL_TRACE_HOST=localhost
THARSIS_OTEL_TRACE_PORT=4317

# =============================================================================
# END OF CONFIGURATION
# =============================================================================
